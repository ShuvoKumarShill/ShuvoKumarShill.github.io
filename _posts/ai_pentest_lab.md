# Professional AI Pentesting Lab - Complete Setup Guide

## Executive Summary
This document provides a complete, production-ready AI pentesting laboratory setup with three tier configurations based on laptop specifications. Each tier includes software stack, cost analysis, and step-by-step implementation.

---

## Table of Contents
1. [Hardware Tier Classifications](#hardware-tier-classifications)
2. [Core Software Stack](#core-software-stack)
3. [Tier-Specific Configurations](#tier-specific-configurations)
4. [Installation & Setup Procedures](#installation--setup-procedures)
5. [Cost Analysis](#cost-analysis)
6. [Network Architecture](#network-architecture)
7. [Security Hardening](#security-hardening)
8. [Operational Procedures](#operational-procedures)

---

## 1. Hardware Tier Classifications

### Tier 1: Entry Level (Budget Laptop)
- **CPU:** Intel i5/AMD Ryzen 5 (4 cores)
- **RAM:** 8-16 GB
- **GPU:** Integrated graphics
- **Storage:** 256-512 GB SSD
- **Use Case:** Basic AI model testing, automated scanning, documentation

### Tier 2: Professional (Mid-Range Laptop)
- **CPU:** Intel i7/AMD Ryzen 7 (6-8 cores)
- **RAM:** 16-32 GB
- **GPU:** NVIDIA GTX 1650/RTX 3050 (4GB VRAM)
- **Storage:** 512 GB - 1 TB NVMe SSD
- **Use Case:** ML model analysis, adversarial testing, medium-scale attacks

### Tier 3: Enterprise (High-End Laptop)
- **CPU:** Intel i9/AMD Ryzen 9 (8+ cores)
- **RAM:** 32-64 GB
- **GPU:** NVIDIA RTX 3060/3070/4060 (8GB+ VRAM)
- **Storage:** 1-2 TB NVMe SSD
- **Use Case:** Deep learning attacks, large model training, GPU-accelerated cracking

---

## 2. Core Software Stack (All Tiers)

### 2.1 Operating System Foundation
```
Primary OS: Kali Linux 2024.x (Rolling Release)
Alternative: Ubuntu 22.04 LTS + Security Tools
Virtualization: VirtualBox 7.0 or VMware Workstation Player
Container Engine: Docker 24.x + Docker Compose
```

### 2.2 AI/ML Pentesting Tools (Open Source)

#### **A. AI Model Security Testing**
| Tool | Purpose | Cost | License |
|------|---------|------|---------|
| **Adversarial Robustness Toolbox (ART)** | Adversarial attack framework | FREE | MIT |
| **CleverHans** | ML security library | FREE | MIT |
| **Foolbox** | Adversarial attacks library | FREE | MIT |
| **TextAttack** | NLP model attacks | FREE | MIT |
| **DeepFool** | Minimal adversarial perturbations | FREE | MIT |

#### **B. Traditional Pentesting Core**
| Tool | Purpose | Cost | License |
|------|---------|------|---------|
| **Metasploit Framework** | Exploitation framework | FREE | BSD |
| **Burp Suite Community** | Web app security | FREE | Community |
| **OWASP ZAP** | Web app scanner | FREE | Apache 2.0 |
| **Nmap** | Network discovery | FREE | GPL |
| **Wireshark** | Network protocol analyzer | FREE | GPL |
| **Nikto** | Web server scanner | FREE | GPL |
| **SQLMap** | SQL injection tool | FREE | GPL |
| **Hydra** | Login brute-forcer | FREE | AGPL |

#### **C. AI-Specific Reconnaissance**
| Tool | Purpose | Cost | License |
|------|---------|------|---------|
| **Shodan CLI** | IoT/ML device discovery | $59/year | Proprietary |
| **Censys** | Internet-wide scanning | FREE tier | Freemium |
| **AI Incident Database Tools** | Vulnerability research | FREE | Open |

#### **D. Machine Learning Frameworks**
| Framework | Purpose | Cost | GPU Support |
|-----------|---------|------|-------------|
| **TensorFlow** | ML model manipulation | FREE | YES |
| **PyTorch** | Deep learning attacks | FREE | YES |
| **scikit-learn** | Classical ML attacks | FREE | Limited |
| **Keras** | High-level neural networks | FREE | YES |
| **ONNX Runtime** | Model conversion/testing | FREE | YES |

#### **E. Password & Hash Cracking**
| Tool | Purpose | Cost | GPU Accel |
|------|---------|------|-----------|
| **Hashcat** | Password recovery | FREE | YES |
| **John the Ripper** | Password cracker | FREE | LIMITED |
| **CrackStation** | Online hash lookup | FREE | N/A |

#### **F. Specialized AI Security Tools**
```
1. ModelScan - ML model malware scanner
2. AI Fairness 360 - Bias detection framework
3. PromptInject - LLM injection testing
4. Garak - LLM vulnerability scanner
5. PurpleLlama - Meta's AI security tools
6. CounterFit - Azure's AI security testing
```

### 2.3 Development & Analysis Environment
```
Python: 3.10+ with pip, venv
Jupyter Notebook/Lab: Interactive analysis
Visual Studio Code: Primary IDE
Git: Version control
Anaconda/Miniconda: Environment management
```

### 2.4 Documentation & Reporting
```
CherryTree: Note-taking for pentesters
KeepNote: Alternative note-taking
Dradis: Reporting framework
Faraday: Collaborative penetration test IDE
Markdown + Pandoc: Professional reports
```

---

## 3. Tier-Specific Configurations

### TIER 1: Entry Level Setup

**Virtual Machine Configuration:**
```
VM 1: Kali Linux
- RAM: 4 GB
- CPU: 2 cores
- Disk: 60 GB
- Purpose: Main pentesting platform

VM 2: Vulnerable Targets (Optional)
- RAM: 2 GB
- CPU: 1 core
- Disk: 20 GB
- Examples: DVWA, Metasploitable
```

**Software Installation Priority:**
```bash
# Essential Tools Only
1. Nmap, Wireshark, Burp Suite Community
2. Python + TensorFlow (CPU only)
3. ART, CleverHans (lightweight)
4. Metasploit Framework
5. Basic ML models (<500MB)
```

**Limitations & Workarounds:**
- Focus on pre-trained model attacks
- Use cloud GPUs for heavy tasks (Google Colab FREE)
- Limit concurrent processes
- Use lightweight Linux distributions

---

### TIER 2: Professional Setup

**Virtual Machine Configuration:**
```
VM 1: Kali Linux Advanced
- RAM: 8 GB
- CPU: 4 cores
- Disk: 100 GB
- GPU: Passthrough if available

VM 2: Windows Target
- RAM: 4 GB
- CPU: 2 cores
- Disk: 60 GB

VM 3: Linux Server Target
- RAM: 2 GB
- CPU: 1 core
- Disk: 30 GB

Docker Containers: 5-10 concurrent
```

**Full Software Stack:**
```bash
# Complete Installation
1. All Tier 1 tools
2. PyTorch with CUDA support
3. Hashcat GPU acceleration
4. Multiple victim environments
5. Custom ML model training (small models)
6. Burp Suite Professional (Trial/Paid)
```

**GPU Optimization:**
```bash
# CUDA Setup for NVIDIA
CUDA Toolkit: 11.8 or 12.x
cuDNN: Latest compatible version
TensorFlow-GPU: 2.15+
PyTorch with CUDA: Latest stable
```

---

### TIER 3: Enterprise Setup

**Bare Metal + VM Hybrid:**
```
Host OS: Ubuntu 22.04 LTS
- Full hardware access
- Docker for containerized targets
- KVM/QEMU for VMs

VM Fleet:
- 3x Kali Linux (different configs)
- 2x Windows Server/10/11
- 2x Linux variants (Ubuntu, CentOS)
- 1x macOS (if hardware permits)
- Kubernetes cluster (3 nodes)
```

**Advanced Infrastructure:**
```
Network Simulation: GNS3 or EVE-NG
Traffic Analysis: Security Onion
SIEM: ELK Stack or Wazuh
Vulnerability Management: OpenVAS
AI Model Repository: MLflow
```

**Maximum Performance Setup:**
```bash
# GPU-Accelerated Everything
- Parallel model testing (4-8 models)
- Large language model attacks
- Distributed cracking with hashcat
- Real-time adversarial generation
- Custom neural architecture attacks
```

---

## 4. Installation & Setup Procedures

### Phase 1: Base System Setup (All Tiers)

```bash
# Step 1: Download Kali Linux
wget https://cdimage.kali.org/kali-2024.3/kali-linux-2024.3-installer-amd64.iso

# Step 2: Create VM in VirtualBox
- Name: KaliPentestLab
- Type: Linux
- Version: Debian (64-bit)
- Allocate resources per tier

# Step 3: Install Kali Linux
- Choose "Graphical Install"
- Hostname: kali-aipentest
- Domain: local
- Select all desktop environments
- Install GRUB bootloader

# Step 4: Post-Installation Update
sudo apt update && sudo apt full-upgrade -y
sudo apt install -y kali-linux-large
```

### Phase 2: AI/ML Tools Installation

```bash
# Install Python Environment
sudo apt install -y python3-pip python3-venv python3-dev
python3 -m venv ~/aipentest-env
source ~/aipentest-env/bin/activate

# Install Core ML Libraries
pip install --upgrade pip
pip install tensorflow torch torchvision
pip install numpy pandas scikit-learn matplotlib seaborn
pip install jupyter notebook ipython

# Install AI Security Tools
pip install adversarial-robustness-toolbox
pip install cleverhans
pip install foolbox
pip install textattack
pip install art

# Install Additional Tools
pip install transformers  # Hugging Face
pip install keras
pip install onnx onnxruntime
```

### Phase 3: GPU Setup (Tier 2 & 3)

```bash
# NVIDIA Driver Installation (Ubuntu/Kali)
sudo apt install -y nvidia-driver-535
sudo reboot

# Verify GPU Detection
nvidia-smi

# Install CUDA Toolkit
wget https://developer.download.nvidia.com/compute/cuda/12.3.0/local_installers/cuda_12.3.0_545.23.06_linux.run
sudo sh cuda_12.3.0_545.23.06_linux.run

# Install cuDNN
# Download from NVIDIA (requires account)
sudo dpkg -i cudnn-local-repo-ubuntu2204-8.9.6.50_1.0-1_amd64.deb
sudo apt update
sudo apt install -y libcudnn8 libcudnn8-dev

# Verify Installation
python3 -c "import tensorflow as tf; print(tf.config.list_physical_devices('GPU'))"
```

### Phase 4: Docker Environment

```bash
# Install Docker
curl -fsSL https://get.docker.com -o get-docker.sh
sudo sh get-docker.sh
sudo usermod -aG docker $USER

# Install Docker Compose
sudo apt install -y docker-compose

# Pull Vulnerable Containers
docker pull vulnerables/web-dvwa
docker pull bkimminich/juice-shop
docker pull citizenstig/dvwa
docker pull webgoat/goatandwolf

# NVIDIA Docker for GPU (Tier 2+)
distribution=$(. /etc/os-release;echo $ID$VERSION_ID)
curl -s -L https://nvidia.github.io/nvidia-docker/gpgkey | sudo apt-key add -
curl -s -L https://nvidia.github.io/nvidia-docker/$distribution/nvidia-docker.list | sudo tee /etc/apt/sources.list.d/nvidia-docker.list
sudo apt update && sudo apt install -y nvidia-docker2
sudo systemctl restart docker
```

### Phase 5: Pentesting Tools Configuration

```bash
# Update Metasploit
sudo msfupdate

# Configure Burp Suite
- Download from: https://portswigger.net/burp/communitydownload
- Install: sudo sh burpsuite_community_linux.sh
- Setup proxy: 127.0.0.1:8080

# Install Additional Tools
sudo apt install -y \
    nmap wireshark \
    sqlmap nikto \
    hydra john \
    gobuster dirb \
    hashcat aircrack-ng \
    exploitdb maltego

# Setup Shodan
pip install shodan
shodan init YOUR_API_KEY
```

---

## 5. Cost Analysis

### Tier 1: Entry Level Budget

| Category | Item | Cost |
|----------|------|------|
| **Hardware** | Existing laptop | $0 |
| **OS** | Kali Linux | FREE |
| **Core Tools** | Open source suite | FREE |
| **Cloud GPU** | Google Colab Pro | $9.99/mo (optional) |
| **Learning** | Online courses (Udemy) | $50-100 (optional) |
| **API Access** | Shodan Basic | $59/year (optional) |
| **Total (Minimal)** | | **$0** |
| **Total (Optimal)** | | **$20-30/month** |

### Tier 2: Professional Budget

| Category | Item | Cost |
|----------|------|------|
| **Hardware** | Existing laptop | $0 |
| **OS & VM** | Kali + VirtualBox | FREE |
| **Burp Suite Pro** | Professional license | $449/year |
| **Shodan** | Membership | $59/year |
| **Training** | Certifications (eLearnSecurity) | $500-1000 |
| **Books** | Technical references | $100-200 |
| **Cloud Resources** | AWS/GCP credits | $50/month |
| **Total (Annual)** | | **$1,200-2,000** |
| **Monthly Average** | | **$100-167** |

### Tier 3: Enterprise Budget

| Category | Item | Cost |
|----------|------|------|
| **Hardware** | Existing laptop | $0 |
| **Software Licenses** | Burp Suite Pro + Extensions | $449-999/year |
| **Cloud Infrastructure** | AWS/Azure lab environment | $200-500/month |
| **Advanced Training** | OSCP/OSEP/PNPT | $1,500-3,000 |
| **Security Tools** | Cobalt Strike (Licensed) | $3,500/year |
| **Bug Bounty Platforms** | Subscriptions | $0-500/month |
| **Conferences** | DEF CON, Black Hat | $1,000-3,000/year |
| **Total (Annual)** | | **$8,000-15,000** |
| **Monthly Average** | | **$667-1,250** |

### Free Alternative Stack (All Tiers)
**Total Cost: $0**
- All tools listed are open source
- Use free cloud tiers (AWS Free Tier, GCP $300 credit)
- Community editions of commercial tools
- YouTube/GitHub for training
- Public bug bounty platforms for practice

---

## 6. Network Architecture

### Isolated Lab Network Design

```
┌─────────────────────────────────────────┐
│         Host Machine (Physical)         │
│  ┌───────────────────────────────────┐  │
│  │     NAT Network (10.0.2.0/24)     │  │
│  │  ┌─────────────────────────────┐  │  │
│  │  │  Kali Linux (Attacker)      │  │  │
│  │  │  IP: 10.0.2.15              │  │  │
│  │  └─────────────────────────────┘  │  │
│  │                                    │  │
│  │  ┌─────────────────────────────┐  │  │
│  │  │  Target Network             │  │  │
│  │  │  (Internal: 192.168.56.0/24)│  │  │
│  │  │  ┌─────────┐  ┌───────────┐ │  │  │
│  │  │  │ DVWA    │  │ Metasploit│ │  │  │
│  │  │  │ .101    │  │ able .102 │ │  │  │
│  │  │  └─────────┘  └───────────┘ │  │  │
│  │  │  ┌─────────┐  ┌───────────┐ │  │  │
│  │  │  │ Win10   │  │ AI Model  │ │  │  │
│  │  │  │ .103    │  │ Server    │ │  │  │
│  │  │  └─────────┘  │ .104      │ │  │  │
│  │  │               └───────────┘ │  │  │
│  │  └─────────────────────────────┘  │  │
│  └───────────────────────────────────┘  │
└─────────────────────────────────────────┘
```

### Network Configuration Commands

```bash
# Create isolated network in VirtualBox
VBoxManage natnetwork add --netname aipentest --network "10.0.2.0/24" --enable
VBoxManage natnetwork modify --netname aipentest --port-forward-4 "ssh:tcp:[]:2222:[10.0.2.15]:22"

# Create host-only network
VBoxManage hostonlyif create
VBoxManage hostonlyif ipconfig vboxnet0 --ip 192.168.56.1 --netmask 255.255.255.0
```

---

## 7. Security Hardening

### Host Machine Protection

```bash
# Firewall Configuration
sudo ufw enable
sudo ufw default deny incoming
sudo ufw default allow outgoing
sudo ufw allow 22/tcp  # SSH (if needed)

# Disable unnecessary services
sudo systemctl disable bluetooth
sudo systemctl disable cups

# Encrypted storage
# Use LUKS full disk encryption during installation
```

### VM Security Best Practices

1. **Snapshot Management**
   - Create snapshot before each test
   - Name snapshots with date and purpose
   - Regular cleanup of old snapshots

2. **Network Isolation**
   - Never bridge VMs directly to home network
   - Use NAT or Host-Only networks
   - Implement virtual firewall rules

3. **Data Protection**
   - Encrypt sensitive findings
   - Use password manager (KeePassXC)
   - Regular backups to external drive

---

## 8. Operational Procedures

### Daily Workflow

```bash
# Morning Routine
1. Start host machine
2. Launch primary Kali VM
3. Update CVE databases
   sudo apt update
   searchsploit -u
   msfupdate
4. Check for tool updates
5. Review scheduled tasks

# Testing Session
1. Create VM snapshot
2. Start target environments
3. Document all activities in CherryTree
4. Execute tests following methodology
5. Capture evidence (screenshots, logs)

# End of Day
1. Export notes and findings
2. Shutdown targets gracefully
3. Backup critical data
4. Revert VMs if compromised
5. Update project documentation
```

### AI Model Pentesting Methodology

```python
# Example: Testing ML Model for Adversarial Attacks

from art.attacks.evasion import FastGradientMethod
from art.estimators.classification import TensorFlowV2Classifier
import tensorflow as tf

# 1. Load target model
model = tf.keras.models.load_model('target_model.h5')

# 2. Wrap with ART classifier
classifier = TensorFlowV2Classifier(
    model=model,
    nb_classes=10,
    input_shape=(28, 28, 1)
)

# 3. Create adversarial attack
attack = FastGradientMethod(
    estimator=classifier,
    eps=0.3
)

# 4. Generate adversarial examples
x_test_adv = attack.generate(x=x_test)

# 5. Evaluate attack success
predictions_adv = classifier.predict(x_test_adv)
accuracy_adv = np.sum(np.argmax(predictions_adv, axis=1) == y_test) / len(y_test)

print(f"Adversarial Accuracy: {accuracy_adv*100:.2f}%")
```

### Reporting Template Structure

```markdown
# Penetration Test Report

## Executive Summary
- Engagement overview
- Key findings summary
- Risk ratings

## Scope
- Target systems
- Testing dates
- Methodology

## Findings
### HIGH RISK
1. AI Model Evasion Attack
   - Description
   - Impact
   - Evidence
   - Remediation

### MEDIUM RISK
[...]

## Technical Details
- Tools used
- Attack vectors
- Proof of concept

## Recommendations
- Prioritized fixes
- Security enhancements

## Appendices
- Full vulnerability list
- Screenshots
- Code samples
```

---

## 9. Learning Path & Resources

### Beginner Track (Tier 1)
1. **Linux Fundamentals** (2 weeks)
2. **Networking Basics** (2 weeks)
3. **Python Programming** (4 weeks)
4. **Introduction to Pentesting** (4 weeks)
5. **AI/ML Basics** (4 weeks)

### Intermediate Track (Tier 2)
1. **Advanced Web App Testing** (4 weeks)
2. **Network Penetration Testing** (4 weeks)
3. **Machine Learning Security** (6 weeks)
4. **Adversarial ML Attacks** (4 weeks)

### Advanced Track (Tier 3)
1. **OSCP Preparation** (3-6 months)
2. **AI Red Teaming** (ongoing)
3. **Zero-day Research** (ongoing)
4. **Custom Tool Development** (ongoing)

### Free Resources
- **TryHackMe** - Interactive learning
- **HackTheBox** - Practice labs
- **PortSwigger Academy** - Web security
- **OWASP** - Security standards
- **arXiv.org** - AI security research papers
- **YouTube** - IppSec, John Hammond, LiveOverflow

---

## 10. Troubleshooting Guide

### Common Issues & Solutions

**Issue: VM Performance Lag**
```bash
# Solution: Optimize resources
- Reduce VM RAM allocation
- Disable 3D acceleration
- Use paravirtualization
- Close unnecessary host applications
```

**Issue: GPU Not Detected in VM**
```bash
# Solution: GPU passthrough
1. Enable VT-d in BIOS
2. Install VirtualBox Extension Pack
3. Configure VM for GPU passthrough
OR use host machine directly for GPU tasks
```

**Issue: Docker Container Network Issues**
```bash
# Solution: Reset Docker networking
sudo systemctl restart docker
docker network prune
docker network create --driver bridge pentest-net
```

**Issue: Tool Installation Failures**
```bash
# Solution: Dependency resolution
sudo apt --fix-broken install
pip install --upgrade pip setuptools wheel
Use virtual environments to avoid conflicts
```

---

## 11. Maintenance Schedule

### Weekly Tasks
- Update Kali Linux: `sudo apt update && sudo apt upgrade`
- Update Python packages: `pip list --outdated`
- Review security news and new CVEs
- Backup important findings

### Monthly Tasks
- Full system backup
- Clean up old VMs and snapshots
- Update all tools and frameworks
- Review and update documentation
- Test backup restoration

### Quarterly Tasks
- Hardware health check
- Storage optimization
- Review security posture
- Update lab architecture
- Plan new tool additions

---

## 12. Next Steps & Expansion

### Immediate Actions (Week 1)
1. Choose tier based on hardware
2. Download Kali Linux ISO
3. Install VirtualBox/VMware
4. Create first VM
5. Install base tools

### Short-term Goals (Month 1-3)
1. Complete basic tool familiarization
2. Setup all victim environments
3. Practice on vulnerable VMs
4. Document first findings
5. Join online communities

### Long-term Goals (6-12 months)
1. Achieve certification (eJPT/PNPT)
2. Contribute to bug bounty programs
3. Develop custom tools
4. Present at local meetups
5. Build professional portfolio

---

## Appendix A: Quick Reference Commands

```bash
# Nmap Scans
nmap -sV -sC -oA scan_results target.com
nmap -p- --min-rate=1000 target.com

# Burp Suite via CLI
java -jar burpsuite.jar &

# Metasploit
msfconsole
search type:exploit platform:windows
use exploit/multi/handler

# Hashcat
hashcat -m 0 -a 0 hashes.txt wordlist.txt
hashcat -m 1000 -a 0 ntlm_hashes.txt rockyou.txt --force

# Docker Quick Start
docker run -d -p 80:80 vulnerables/web-dvwa
docker ps
docker exec -it container_id /bin/bash

# Python AI Testing
python test_adversarial.py --model model.h5 --attack fgsm
```

## Appendix B: Essential Keyboard Shortcuts

**Kali Linux**
- Ctrl+Alt+T: Open terminal
- Ctrl+Shift+T: New terminal tab
- Alt+F2: Run command

**Burp Suite**
- Ctrl+R: Send to Repeater
- Ctrl+I: Send to Intruder
- Ctrl+Shift+B: Toggle proxy interception

---

## Support & Community

**Forums & Communities**
- Reddit: r/netsec, r/AskNetsec, r/howtohack
- Discord: Many pentesting servers
- Twitter: #infosec #pentesting
- GitHub: Star useful repositories

**Professional Organizations**
- OWASP
- (ISC)²
- EC-Council
- Offensive Security

---

**Document Version:** 2.0  
**Last Updated:** October 2025  
**Author:** Professional Pentesting Lab Blueprint  
**License:** Educational Use Only - Practice Ethically & Legally

---

*Disclaimer: This lab is for authorized security testing and educational purposes only. Unauthorized access to computer systems is illegal. Always obtain proper authorization before testing.*